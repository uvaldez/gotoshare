/*! Native Promise Only
    v0.3.1-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(t,e,n){e[t]=e[t]||n(),"undefined"!=typeof module&&module.exports?module.exports=e[t]:"function"==typeof define&&define.amd&&define(function(){return e[t]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function t(t){p?(p=!1,t()):v?setImmediate(t):setTimeout(t,0)}function e(t){var e,n=typeof t;return null===t||"object"!==n&&"function"!==n||(e=t.then),"function"==typeof e?e:!1}function n(){var t,n,i,r,o;switch(this.state){case 0:return p=!1;case 1:o=this.success,this.failure.length=0;break;case 2:o=this.failure,this.success.length=0}for(;(t=o.shift())||t===!1;){r=this.chained.shift();try{t===!1?(p=!0,r.reject(this.msg)):(n=t===!0?this.msg:t(this.msg),p=!0,n===r.promise?r.reject(TypeError("Promise-chain cycle")):(i=e(n))?i.call(n,r.resolve,r.reject):r.resolve(n))}catch(s){p=!0,r.reject(s)}}}function i(r){var s,c,u;if(this.def){if(this.triggered)return p=!1;this.triggered=!0,c=this.def}else c=this;if(0!==c.state)return p=!1;u={def:c,triggered:!1};try{(s=e(r))?s.call(r,i.bind(u),o.bind(u)):(c.msg=r,c.state=1,t(n.bind(c)))}catch(f){o.call(u,f)}}function r(t){return this.triggered?void(p=!1):(this.triggered=!0,void i.call(this,t))}function o(e){var i;if(this.def){if(this.triggered)return p=!1;this.triggered=!0,i=this.def}else i=this;return 0!==i.state?p=!1:(i.msg=e,i.state=2,void t(n.bind(i)))}function s(t){return this.triggered?void(p=!1):(this.triggered=!0,void o.call(this,t))}function c(t,e){h(t,e),this.chained.push({resolve:t,reject:e})}function u(t,e){p=!0,t(e)}function f(t,e){return Array.isArray(e)?void 0:t.reject(TypeError("Expected array argument"))}function h(t,e){if("function"!=typeof t)throw Error("Resolver is not a function");if("function"!=typeof e)throw Error("Rejecter is not a function")}function a(t,e,n,i){e.forEach(function(e,r){t.resolve(e).then(n.bind(null,r),i)})}function d(e,i){this.success.push("function"==typeof e?e:!0),this.failure.push("function"==typeof i?i:!1);var r=new this.Constructor(c.bind(this));return this.chained[this.chained.length-1].promise=r,t(n.bind(this)),r}function l(t){return this.promise.then(void 0,t)}function g(t){if("function"!=typeof t)throw TypeError("Expected function argument");var e={Constructor:g,promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};y(this,"then",d.bind(e)),y(this,"catch",l.bind(e));try{t(r.bind(e),s.bind(e))}catch(n){o.call(e,n)}}var p=!1,v="undefined"!=typeof setImmediate,y=Object.defineProperty?function(t,e,n,i){return Object.defineProperty(t,e,{value:n,writable:!0,configurable:i!==!1})}:function(t,e,n){return t[e]=n,t};return y(g,"prototype",{value:y({},"constructor",g)},!1),y(g,"resolve",function(e){var n=this;return"object"==typeof e&&e instanceof n?e:new n(function(n,i){h(n,i),t(u.bind(null,n,e))})}),y(g,"reject",function(t){return new this(function(e,n){h(e,n),n(t)})}),y(g,"all",function(t){var e,n=this;return(e=f(n,t))?e:0===t.length?n.resolve([]):new n(function(e,i){function r(t,n){o[t]=n,s++,s===c&&u(e,o)}h(e,i);var o=[],s=0,c=t.length;a(n,t,r,i)})}),y(g,"race",function(t){var e,n=this;return(e=f(n,t))?e:new n(function(e,i){h(e,i),a(n,t,function(t,n){u(e,n)},i)})}),g});
