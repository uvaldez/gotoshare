/*! Native Promise Only
    v0.3.0-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(e,t,n){t[e]=t[e]||n(),"undefined"!=typeof module&&module.exports?module.exports=t[e]:"function"==typeof define&&define.amd&&define(function(){return t[e]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function e(e){g?(g=!1,e()):p?setImmediate(e):setTimeout(e,0)}function t(e){var t,n=typeof e;return null===e||"object"!==n&&"function"!==n||(t=e.then),"function"==typeof t?t:!1}function n(){var e,n,i,r,s;switch(this.state){case 0:return g=!1;case 1:s=this.success,this.failure.length=0;break;case 2:s=this.failure,this.success.length=0}for(;(e=s.shift())||e===!1;){r=this.chained.shift();try{e===!1?(g=!0,r.reject(this.msg)):(n=e===!0?this.msg:e(this.msg),g=!0,n===r.promise?r.reject(TypeError("Promise-chain cycle")):(i=t(n))?i.call(n,r.resolve,r.reject):r.resolve(n))}catch(c){g=!0,r.reject(c)}}}function i(r){var c,o,u;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,o=this.def}else o=this;if(0!==o.state)return g=!1;u={def:o,triggered:!1};try{(c=t(r))?c.call(r,i.bind(u),s.bind(u)):(o.msg=r,o.state=1,e(n.bind(o)))}catch(f){s.call(u,f)}}function r(e){return this.triggered?void(g=!1):(this.triggered=!0,void i.call(this,e))}function s(t){var i;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,i=this.def}else i=this;return 0!==i.state?g=!1:(i.msg=t,i.state=2,void e(n.bind(i)))}function c(e){return this.triggered?void(g=!1):(this.triggered=!0,void s.call(this,e))}function o(e,t){this.chained.push({resolve:e,reject:t})}function u(e,t){g=!0,e(t)}function f(e){return Array.isArray(e)?void 0:l.reject(TypeError("Expected array argument"))}function h(e,t,n){e.forEach(function(e,i){l.resolve(e).then(t.bind(null,i),n)})}function a(t,i){this.success.push("function"==typeof t?t:!0),this.failure.push("function"==typeof i?i:!1);var r=new l(o.bind(this));return this.chained[this.chained.length-1].promise=r,e(n.bind(this)),r}function d(e){return this.promise.then(void 0,e)}function l(e){if("function"!=typeof e)throw TypeError("Expected function argument");var t={promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};v(this,"then",a.bind(t)),v(this,"catch",d.bind(t));try{e(r.bind(t),c.bind(t))}catch(n){s.call(t,n)}}var g=!1,p="undefined"!=typeof setImmediate,v=Object.defineProperty?function(e,t,n,i){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:i!==!1})}:function(e,t,n){return e[t]=n,e};return v(l,"prototype",{value:v({},"constructor",l)},!1),v(l,"resolve",function(t){return"object"==typeof t&&t instanceof l?t:new l(function(n){e(u.bind(null,n,t))})}),v(l,"reject",function(e){return new l(function(t,n){n(e)})}),v(l,"all",function(e){var t;return(t=f(e))?t:0===e.length?l.resolve([]):new l(function(t,n){function i(e,n){r[e]=n,s++,s===c&&u(t,r)}var r=[],s=0,c=e.length;h(e,i,n)})}),v(l,"race",function(e){var t;return(t=f(e))?t:new l(function(t,n){h(e,function(e,n){u(t,n)},n)})}),l});
